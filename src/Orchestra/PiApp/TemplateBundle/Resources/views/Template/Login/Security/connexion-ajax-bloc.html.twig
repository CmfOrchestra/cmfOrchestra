<script type="text/javascript">
//<![CDATA[
    $(document).ready(function() {
        $('#form-connexion-block').on('submit', function(e) {
			e.preventDefault()
	        
        	var _username 	= jQuery(this).find('input[name="_username"]').val();
        	var _password 	= jQuery(this).find('input[name="_password"]').val();
        	var _csrf_token = jQuery(this).find('input[name="_csrf_token"]').val();
        	// var _return = true;
        	
            $.ajax({
                url: $(this).attr('action'),
                data: "_username="+_username+"&_password="+_password+"&_csrf_token="+_csrf_token,
                type: $(this).attr('method'),
                success: function(html) {
                	if ( /Bad credentials/i.test(html)==true ) {
                		// alert("Erreur de connexion");
                		$('#form-connexion-block').addClass('errorConnect');
                	} else {
                		{% if referer_url != "" %}
                		document.location.href = "{{ referer_url }}";
                		{% else %}
                		window.location.reload();
                		{% endif %}
                	}
                }
            });
        });
    });
//]]>
</script>